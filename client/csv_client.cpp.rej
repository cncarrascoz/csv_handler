@@ -29,6 +29,40 @@
     
     Status status = stub_->ListLoadedFiles(&context, request, &response);
     
+    if (!status.ok() && server_addresses_.size() > 1) {
+        // Connection failed, try to reconnect to another server
+        return try_reconnect();
+    }
+    
     return status.ok();
 }
 
+// Get cluster status from the server
+bool CsvClient::get_cluster_status(std::string& leader, std::vector<std::string>& servers, int& active_count) {
+    csvservice::Empty request;
+    csvservice::ClusterStatusResponse response;
+    grpc::ClientContext context;
+    
+    Status status = stub_->GetClusterStatus(&context, request, &response);
+    
+    if (!status.ok()) {
+        if (server_addresses_.size() > 1) {
+            // Try to reconnect to another server
+            if (try_reconnect()) {
+                // Try again with the new connection
+                return get_cluster_status(leader, servers, active_count);
+            }
+        }
+        return false;
+    }
+    
+    // Extract cluster status information
+    leader = response.leader_address();
+    
+    servers.clear();
+    for (int i = 0; i < response.server_addresses_size(); i++) {
+        servers.push_back(response.server_addresses(i));
+    }
+    
+    active_count = response.active_server_count();
+    
